{{ $featured := where (where (where .Site.Pages "Section" "project") ".Params.type" "case-study") ".Params.featured" true }}

<h2>ðŸŒŸ Featured Case Studies</h2>
{{ if gt (len $featured) 0 }}
<div class="carousel-container mb-5">
    <div class="carousel">
        <!-- Carousel Items -->
        {{ range sort (where .Site.Pages "Section" "project") "Date" "desc" }}
            {{ if and (eq (index .Params "type") "case-study") (index .Params "featured") }}
              <div class="carousel-item is-active">
                  <div class="card">
                      <div class="card-image">
                          <figure class="image">
                              <img src="{{ absURL "project/case-studies/" }}{{ .Params.thumbnail }}" alt="Product 1">
                          </figure>
                      </div>
                      <div class="card-content has-text-centered">
                          <p class="title is-6 truncate-one-line">{{.Title}}</p>
                          <a class="button is-success is-rounded" href="{{ .RelPermalink }}">More details</a>
                      </div>
                  </div>
              </div>
            {{ end }}
        {{ end }}
    </div>
    
    <!-- Navigation Arrows -->
    <button class="carousel-nav carousel-nav-prev">
        <span class="icon is-large">
            <i class="fas fa-chevron-left fa-2x"></i>
        </span>
    </button>
    <button class="carousel-nav carousel-nav-next">
        <span class="icon is-large">
            <i class="fas fa-chevron-right fa-2x"></i>
        </span>
    </button>
    
    <!-- Indicators -->
    <div class="carousel-indicators">
      {{ range $i, $item := $featured }}
        <button class="carousel-indicator{{ if eq $i 0 }} is-active{{ end }}"></button>
      {{ end }}
    </div>
</div>
{{ $carouseljs := resources.Get "js/carousel.js" | resources.Minify }}
<script src="{{ $carouseljs.RelPermalink }}"></script>
{{ else }}

<p>No featured case studies available at the moment. Check back soon for highlighted success stories!</p>
{{ end }}

<h2>Active Case Studies</h2>

<div class="grid">
  {{ range sort (where .Site.Pages "Section" "project") "Date" "desc" }}
    {{ if eq (index .Params "type") "case-study" }}
      {{ partial "usecase.html" . }}
    {{ end }}
  {{ end }}
</div>
  